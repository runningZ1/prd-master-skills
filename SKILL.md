---
name: "prd-master"
description: "统一PRD工具：集学习、生成与执行为一体。智能检测用户需求，提供三种模式：PRD方法论学习、通用PRD生成、TaskMaster完整工作流。支持从概念到执行的完整产品需求文档生命周期。"
allowed-tools: [Read, Write, Edit, Grep, Glob, Bash, AskUserQuestion]
---

# PRD Master - 统一PRD工作台 v3.0

## 🎯 智能模式检测

当您使用此 Skill 时，我会**自动检测**您的需求并引导您到合适的模式：

### 🔍 我如何知道您的需求？

我会分析您的输入中的关键词，判断您需要：

1. **🎓 学习模式** - 了解PRD方法论和最佳实践
2. **🔧 通用生成** - 创建标准PRD文档
3. **🚀 TaskMaster模式** - 生成PRD并执行任务（需要TaskMaster）

### 💡 智能检测示例

| 您的输入 | 我理解您需要 | 自动进入 |
|----------|-------------|----------|
| "什么是PRD？如何写好？" | 学习PRD方法论 | 🎓 学习模式 |
| "为用户认证功能创建PRD" | 生成标准PRD | 🔧 通用生成 |
| "生成PRD并用TaskMaster执行" | 完整PRD+任务执行 | 🚀 TaskMaster模式 |

---

## 🎓 模式一：PRD学习与最佳实践

**适合人群**: 产品经理、技术文档编写者、团队负责人
**使用场景**: 学习写作方法、了解协作流程、提升文档质量

### 核心价值

**文档目的**: 把需求讲清楚 = 合适的方案 + 表达清晰

### 1. PRD核心思路与结构

**总分结构，符合金字塔原理**：

#### 第一部分：为什么要做？
- **目标**: 给大家一个清晰、热血的"远方"（愿景）！让团队知道瞄准哪里开火
- **背景**: 讲"起心动念"的故事，为什么会有这个想法？
- **价值**: 这产品在市场上"是要打哪个山头"（定位）？凭什么我们做得出来、还能赢？
- **目的**: 从系统建设角度给出精简目标

#### 第二部分：要做什么？（PRD六大核心架构）
1. **修订追踪表**: 记录每次修改的位置，避免团队逐页查找变更
2. **背景简介**: 说清楚产品来源、市场问题、与公司业务的关联
3. **功能清单**: 白纸黑字列清楚要做哪些功能，具体、明确
4. **功能流程**: 用流程图展示工作流程，厘清责任、打通协作
5. **功能结构**: 分门别类展示功能模块关系，防止遗漏
6. **页面设计（Wireframe）**: 产品骨架草稿，专注布局和互动

**三个小目标**：
1. 文档受众能精准理解并转化为产出物（代码、测试用例、交互图）
2. 作为多角色间的无歧义标准
3. 可追溯性文件（判断BUG来源、支持后续迭代）

### 2. 整体设计技巧

根据需求特点选择合适的表达方式：

#### 2.1 涉及多个用户角色
**推荐工具**: 泳道流程图
- 纵向/横向表示角色和流程阶段
- 强调角色执行的动作/逻辑判断
- 弱化时间顺序/系统间交互

**适用场景**:
- 涉及多个业务角色的流程
- 需要明确不同角色的职责和操作

#### 2.2 横跨多个系统/领域
**推荐工具**:
- **实体关系图**: 表明不同领域之间的关系（1:1, 1:N, N:1, N:N）
- **时序图**: 描述不同领域/对象之间的交互与通信

**关系类型的产品设计含义**:
- 1:1 关系：最简单，双向都能找到唯一值
- 1:N 关系：从A触发时要有决策逻辑找到B中的某个值
- N:1 关系：从A触发任一值都能找到唯一，反之则不是
- N:N 关系：最复杂，双向都需要决策逻辑

#### 2.3 涉及状态机
**推荐工具**: 有限状态机图
- 明确谁在什么时候触发的动作
- 明确动作后的状态结果
- 标记开始和终止状态

**三个能力要求**:
- 关于动作(action): 明确知道谁在什么时候触发什么动作
- 关于状态(status): 明确预期动作后的状态结果
- 关于整体: 掌握整个单据流的状态变更

### 3. 需求描述最佳实践

#### 3.1 用户操作流程
- 使用流程图清晰展示用户操作路径
- 标注判断节点和异常流程
- 确保流程能够自洽

#### 3.2 字段填写说明
使用表格形式，包含：
- 字段名称
- 必填性
- 样式（文本框、下拉框等）
- 逻辑（默认值、触发条件）
- 校验逻辑及报错文案
- 备注

#### 3.3 系统交互说明
- 使用时序图展示系统间交互
- 明确接口调用关系
- 说明入参、出参和异常处理

#### 3.4 表达技巧

**使用"条件-动作-预期"三段式**:
- **条件**: 前置条件是什么
- **动作**: 触发什么操作
- **预期**: 期望的结果是什么

**示例**:
> 当「手机号填写正确」且「手机号未注册过」(条件)，则会触发短信验证码发送(动作)，预期用户所填写的手机号能收到验证码(预期)。

**清晰表达的六大原则**:

1. **一图解千言**:
   - 图一摆出来，产品流程或功能逻辑马上变直球
   - 团队三秒就能抓到重点，保证误解机率砍半

2. **条列式呈现**:
   - 改需求不折寿：直接插入、删节点
   - 层次瞬间分明：主功能、子规则一眼看穿
   - 抓重点就是快：扫过去要害自动浮现

3. **避免连续文字**:
   - 不要大段连续文字描述
   - 使用条列、表格等结构化方式

4. **面对面确认**:
   - 文档完成后进行1对1确认
   - 当场解答疑问，实时调整

5. **分好项目类型**:
   - 把"旧功能改版"和"全新功能"分开
   - 每条需求都要超连结连回旧版定义

6. **考虑Corner Case**:
   - 不能仅考虑理想状态下的正向流程
   - 必须全面覆盖所有可能出现的情况

### 4. 文档协作机制

#### 4.1 协作流程
1. **需求理解阶段**: 技术团队研读需求，识别可行性问题
2. **技术方案设计**: 基于需求设计方案，评估风险
3. **方案评审**: 需求方参与技术方案评审
4. **文档同步**: 保持版本一致性

#### 4.2 命名规范
- 需求ID: `REQ-XXX`
- 技术方案ID: `TECH-XXX`
- 接口ID: `API-XXX`
- 数据模型ID: `DATA-XXX`

#### 4.3 版本规范
```
版本号格式: v主版本.次版本.修订号
示例: v1.2.3

主版本: 重大需求变更
次版本: 功能增加或修改
修订号: 文档修正和优化
```

### 5. 文档质量评估

#### 5.1 评估维度
- **完整性**: 是否覆盖所有需求点
- **准确性**: 描述是否准确无歧义
- **一致性**: 需求和技术文档是否一致
- **可追溯性**: 是否可以双向追溯
- **时效性**: 文档是否及时更新

### 6. 高质量技术文章写作

#### 6.1 八个核心方法
1. **同理心**: 站在读者角度，讲清楚"是什么，为什么，怎么办"
2. **攒素材**: 养成记录思考过程的习惯
3. **定好题**: 选择有分享欲、较少人写、对他人有价值的主题
4. **搭骨架**: 确定文章结构/框架，方便读者理解和跳转
5. **画好图**: "一图胜千言"，人脑处理图片速度是文字的6万倍
6. **有干货**:
   - 更高的抽象层次，避免过多技术细节
   - 专业性，在熟悉领域写作
   - 有深度，体现领域全面掌握
   - 加入基于实践的理解
7. **勤润色**: 多次润色，改善语言和排版
8. **练内功**: 多读书，学习好的行文习惯

---

## 🔧 模式二：通用PRD生成器

**适合人群**: 产品经理、业务分析师
**使用场景**: 快速生成标准产品需求文档

### 核心工作流

当您请求创建PRD时，我会遵循以下5步工作流：

### Step 1: 收集上下文

在生成PRD之前，我会通过发现式对话收集必要信息：

**必需信息**:
- **功能/产品名称**: 我们要构建什么？
- **问题陈述**: 这个问题要解决什么？
- **目标用户**: 这是为谁准备的？
- **业务目标**: 我们要达到什么目标？
- **成功指标**: 我们如何衡量成功？
- **时间线/约束**: 有什么截止日期或限制？

**发现式问题**:

```
1. 您要解决什么问题？
2. 谁是此功能的主要用户/受众？
3. 关键业务目标是什么？
4. 有我们应该了解的技术限制吗？
5. 成功是什么样子的？您如何衡量？
6. 此功能的时间线是什么？
7. 明确不在范围内的是什么？
```

**注意**: 如果用户一开始就提供了详细的需求说明，您可以跳过一些问题。对于缺失的关键信息，一定要问清楚。

### Step 2: 生成PRD结构

使用标准PRD模板创建结构化文档。PRD应包括：

1. **执行摘要** - 高级概述（2-3段）
2. **问题陈述** - 问题的清晰表述
3. **目标与目的** - 我们要实现什么
4. **用户画像** - 我们为谁构建
5. **用户故事与需求** - 详细功能需求
6. **成功指标** - KPI和测量标准
7. **范围** - 范围内和范围外
8. **技术考虑** - 架构、依赖、约束
9. **设计与UX需求** - UI/UX考虑
10. **时间线与里程碑** - 关键日期和阶段
11. **风险与缓解** - 潜在问题和解决方案
12. **依赖与假设** - 我们依赖什么
13. **开放问题** - 未解决的问题

### Step 3: 创建用户故事

对于每个主要需求，使用标准格式生成用户故事：

```
作为 [用户类型]，
我想 [行动]，
以便 [价值/收益]。

验收标准：
- [具体、可测试的标准1]
- [具体、可测试的标准2]
- [具体、可测试的标准3]
```

参考 `references/user_story_examples.md` 了解常见模式和最佳实践。

### Step 4: 定义成功指标

根据产品类型使用适当的指标框架：

- **AARRR (海盗指标)**: 获取、激活、留存、收入、推荐
- **HEART框架**: 满意度、参与度、采用率、留存率、任务成功率
- **北极星指标**: 代表核心价值的单一关键指标
- **OKRs**: 目标与关键结果

查阅 `references/metrics_frameworks.md` 了解每个框架的详细指导。

### Step 5: 验证与审查

可选运行验证脚本确保PRD完整性：

```bash
scripts/validate_prd.sh <prd_file.md>
```

这会检查：
- 所有必需部分是否存在
- 用户故事是否符合规范
- 是否定义了成功指标
- 范围是否清晰表述
- 是否还有占位符文本

### PRD模板类型

此Skill支持不同的PRD格式：

**标准PRD** - 完整的综合文档
**精益PRD** - 面向敏捷团队的精简版
**一页纸** - 执行摘要格式
**技术PRD** - 面向工程的需求
**设计PRD** - 面向UX/UI的需求

在请求时指定格式："为...创建精益PRD"或"生成技术PRD"

### 最佳实践

#### 编写质量要求

**好的需求是**:
- **具体**: 清晰且无歧义
- **可测量**: 可以验证/测试
- **可实现**: 技术上可行
- **相关**: 与用户/业务价值相关
- **有时限**: 有明确的时间线

**避免**:
- 模糊语言（"快"、"简单"、"直观"）
- 实现细节（让工程师决定如何做）
- 功能蔓延（坚持核心需求）
- 未经验证的假设

#### 用户故事最佳实践

**应该做**:
- 关注用户价值，而非功能
- 从用户角度书写
- 包含清晰的验收标准
- 保持故事独立且小
- 使用一致的格式

**不应该做**:
- 写技术实现细节
- 在故事间创建依赖
- 故事太大（史诗）
- 使用内部行话
- 跳过验收标准

---

## 🚀 模式三：TaskMaster完整工作流

**适合人群**: 工程师、AI辅助开发者
**使用场景**: 生成PRD并自动分解为可执行任务

### ⚠️ 核心要求

此模式**必需** TaskMaster（MCP或CLI）。如果未检测到，会阻塞并提示安装。

### 核心原则

**质量优于速度**: 规划是95%的工作。花时间创建全面的PRDs，实现成功执行。

**TaskMaster必需**: 此Skill需要taskmaster（MCP或CLI）。如果未检测到，会阻塞并提示安装。

**面向工程师**: 主要受众是工程团队。包含技术深度、代码示例、架构考虑和实现细节。

**验证驱动**: 自动化检查确保交付前的PRD质量。自动运行13项验证检查。

**用户测试检查点**: 每5个任务，插入用户验证检查点以早期发现问题。

**完全自动化**: 提供4种自主执行模式，包含git策略、进度日志和日期时间跟踪。

### 工作流概览（12步）

1. **启用计划模式并检查状态** - 恢复检测 + 交互式提示
2. **检测现有PRD** - 智能检测，提供执行/更新/替换选项
3. **检测TaskMaster** - MCP > CLI > 如果缺失则阻塞
4. **发现式问题** - 12+详细问题（如果生成新PRD）
5. **初始化TaskMaster** - 通过MCP/CLI（如果尚未初始化）
6. **生成PRD** - 综合11部分文档（如果创建新文档）
7. **验证质量** - 13项自动化检查
8. **解析并展开** - 结合研究的组合操作
9. **插入用户测试** - 每5个任务检查一次
10. **设置跟踪** - DateTime、回滚、准确性脚本
11. **选择下一步操作** - 移交TaskMaster或自主执行
12. **总结并开始** - 展示概览并开始工作

### 详细实现

#### Step 1: 启用计划模式并检查不完整工作

**Skill激活时的第一个操作**：

```
1. 检查上一会话的不完整工作：
   - 运行：python3 .taskmaster/scripts/execution-state.py（如果存在）
   - 如果发现不完整工作：提供恢复选项

2. 启用计划模式（如果尚未启用）：
   - 这确保AskUserQuestion工具正常工作
   - 通知用户："启用计划模式以进行交互式提示..."

3. 继续Step 2
```

#### Step 2: 检测现有PRD（智能检测）

**第二个操作**：在生成新PRD之前检查PRD是否已存在。

**检测逻辑**：

```
1. 检查 .taskmaster/ 是否存在：
   - 使用 Glob: .taskmaster/
   - NO → 新项目，继续Step 3（检测taskmaster）
   - YES → 继续检查PRD

2. 检查现有PRD：
   - 使用 Glob: .taskmaster/docs/*.md 或 .taskmaster/docs/prd.*
   - 读取 .taskmaster/tasks/tasks.json 获取任务数和状态
   - 找到PRD → 显示现有PRD选项（如下）
   - 没有PRD → 继续Step 3（检测taskmaster）
```

**如果发现现有PRD**：

```
🔍 发现现有PRD: {filename}

📄 PRD详情：
  - 创建时间：{文件日期}
  - 位置：.taskmaster/docs/{filename}
  - 任务：{X总计}（{Y已完成}，{Z待处理}）
  - 状态：{%完成}

您想做什么？

  1. 执行现有PRD的任务
     → 跳到Step 11（选择执行模式）
     → 开始处理待处理任务

  2. 更新/完善现有PRD
     → 编辑当前PRD，添加新需求
     → 重新解析以更新任务
     → 与现有任务列表合并

  3. 创建新PRD（替换当前）
     → 确认："这将替换现有PRD。继续吗？"
     → 继续Step 3（完整PRD生成工作流）

  4. 审查现有PRD
     → 显示当前PRD摘要
     → 显示任务分解
     → 退出Skill

输入：1、2、3或4
```

#### Step 3: 检测TaskMaster（强制 - 如果缺失则阻塞）

**关键**：必须在进行PRD生成之前检测taskmaster。

**检测优先级**：

```
1. 检查MCP Task-Master-AI（首选）：
   - 尝试：mcp__task-master-ai__get_tasks 和 projectRoot
   - 如果成功：TASKMASTER_METHOD="MCP" ✅
   - 注意：MCP提供卓越集成（直接函数调用）

2. 回退到CLI：
   - 运行：which taskmaster
   - 运行：taskmaster --version
   - 如果找到：TASKMASTER_METHOD="CLI" ✅

3. 都不可用：
   - TASKMASTER_METHOD="NONE" ❌
   - 阻塞并显示安装说明
```

**如果未找到TaskMaster**：

```
⚠️ 需要TaskMaster

此Skill需要taskmaster（MCP或CLI）才能正常工作。

我在您的环境中未检测到taskmaster。

选项1（推荐）：安装MCP Task-Master-AI
  • 添加到Claude Code MCP设置
  • 提供与直接函数调用的无缝集成
  • 参见：https://github.com/cyanheads/task-master-ai
  • 安装：添加到MCP配置，重启Claude Code

选项2：安装CLI
  • 运行：npm install -g task-master-ai
  • 使用命令行界面
  • 参见：https://github.com/cyanheads/task-master-ai

请安装taskmaster，完成后输入'done'。

[等待用户安装并确认]
[用户确认后重新检测]
[仅在检测成功后继续]
```

**未检测到TaskMaster则不继续**

#### Step 4: 发现（全面的需求收集）

提出详细问题以确保全面的PRD：

**基本问题（5个）**：
1. 这个问题解决什么？（用户痛点、业务影响）
2. 目标用户/受众是谁？
3. 提议的解决方案或功能是什么？
4. 关键成功指标是什么？（我们如何衡量成功）
5. 存在什么约束？（技术、时间线、资源）

**技术上下文（4个）**：
6. 这是针对现有代码库还是全新项目？
7. 技术栈是什么？（如果知道）
8. 有集成需求吗？（第三方服务、内部系统）
9. 性能/规模要求？（用户、数据量、延迟）

**TaskMaster特定（3个）**：
10. 您以前用过taskmaster吗？（帮助校准详细程度）
11. 估计复杂度如何？（简单功能、典型项目、复杂系统）
12. 时间线期望？（有助于分阶段和任务分解）

**开放题（1个）**：
13. 我还应该知道什么？（边缘案例、约束、上下文）

**智能默认值**：
- 如果用户答案最少，使用最佳猜测并记录假设
- 默认全面详细
- 假设工程师受众，除非另有说明

#### Step 5: 初始化TaskMaster项目

**关键**：仅通过taskmaster MCP/CLI初始化。绝不手动创建.taskmaster/。

#### 如果TASKMASTER_METHOD="MCP"：

```
使用 mcp__task-master-ai__initialize_project：
  - projectRoot: ${PWD}（绝对路径）
  - yes: true（跳过提示）
  - storeTasksInGit: true
  - initGit: false（如果git已存在）
  - skipInstall: false
  - rules: ["claude"]

结果：.taskmaster/ 结构由taskmaster创建
```

#### 如果TASKMASTER_METHOD="CLI"：

```bash
taskmaster init --yes --store-tasks-in-git --rules=claude
```

**输出**：
```
✅ Taskmaster已初始化
   创建：.taskmaster/docs/
   创建：.taskmaster/tasks/
   创建：.taskmaster/reports/
   创建：.taskmaster/state/
   更新：.gitignore
```

#### Step 6: 生成综合PRD

将PRD写入 `.taskmaster/docs/prd.md`

**11个必需部分**：

1. **执行摘要**（2-3句：问题 + 解决方案 + 影响）

2. **问题陈述**
   - 当前情况和痛点
   - 用户影响（谁受影响，如何影响）
   - 业务影响（成本、机会）
   - 为什么现在解决

3. **目标与成功指标**（SMART格式）
   - 3-5个具体目标
   - 每个目标包含：指标、基线、目标、时间框架
   - 示例："3个月内将用户激活率从45%提高到65%"

4. **用户故事**（敏捷格式，专注taskmaster）
   - 作为[用户]，我想要[行动]，以便我可以[收益]
   - 详细验收标准（成为任务完成标准）
   - 每个故事暗示1-3个实现任务

5. **功能需求**
   - 编号（REQ-001、REQ-002等）
   - 优先级（必须有/应该有/可以有）
   - 每个需求是原子的和可测试的
   - 包含taskmaster分解的提示

6. **非功能需求**
   - 性能（包含具体目标："< 200ms p95"）
   - 安全（认证、加密、合规）
   - 可扩展性（用户负载、数据量）
   - 可靠性（正常运行时间、错误率）
   - 可访问性（WCAG标准）
   - 兼容性（浏览器、设备、操作系统）

7. **技术考虑**
   - 架构含义
   - API规范（包含请求/响应示例）
   - 数据库模式更改（包含SQL/模式示例）
   - 依赖（内部和外部）
   - 迁移策略（针对现有系统）
   - 测试策略（单元、集成、e2e）

8. **实施路线图**（TaskMaster优化）
   - 阶段分解（阶段1、2、3...）
   - 任务排序（什么依赖什么）
   - 复杂度估计（用于taskmaster调度）
   - 每个需求的建议任务分解

9. **范围外**
   - 明确列出不包括什么
   - 防止范围蔓延
   - 记录未来考虑

10. **开放问题与风险**
    - 未决定的决策（包含所有者）
    - 已知风险和缓解策略
    - 需要进一步研究的领域

11. **验证检查点**
    - 我们验证进度的里程碑
    - 任务完成的质量关卡

#### Step 7: 验证PRD质量（13项自动化检查）

**必需元素（5项检查）**：
1. ✅ 执行摘要存在（2-3句）
2. ✅ 问题陈述包含用户和业务影响
3. ✅ 所有目标有SMART指标（具体、可测量、可实现、相关、有时限）
4. ✅ 用户故事有验收标准（每个故事最少3个）
5. ✅ 范围外明确定义

**功能需求（3项检查）**：
6. ✅ 所有功能需求可测试（不模糊）
7. ✅ 每个需求有优先级（必须有/应该有/可以有）
8. ✅ 需求已编号（REQ-001、REQ-002等）

**技术考虑（2项检查）**：
9. ✅ 技术考虑解决架构
10. ✅ 非功能需求包含具体目标（不模糊）

**TaskMaster特定（3项检查）**：
11. ✅ 需求有任务分解提示
12. ✅ 依赖已识别用于任务排序
13. ✅ 验收标准具体（可成为任务完成检查）

#### Step 8: 解析PRD并展开任务（单一组合操作）

**重要**：将parse-prd + expand-all与研究结合为单一操作。

**自动计算任务数**：
```
numTasks = （功能需求数 × 1.5）四舍五入
最小值：10个任务
最大值：40个任务
```

#### 如果TASKMASTER_METHOD="MCP"：

```
1. 使用研究解析PRD：
   使用 mcp__task-master-ai__parse_prd：
     - projectRoot: ${PWD}
     - input: ".taskmaster/docs/prd.md"
     - numTasks: 根据需求数自动计算
     - research: true（总是使用研究以获得更好质量）
     - append: false

2. 立即使用研究展开所有任务：
   使用 mcp__task-master-ai__expand_all：
     - projectRoot: ${PWD}
     - research: true（总是使用研究）
     - force: false
```

#### 如果TASKMASTER_METHOD="CLI"：

```bash
# 组合操作：
taskmaster parse-prd --input .taskmaster/docs/prd.md --research --num-tasks auto && \
taskmaster expand-all --research
```

#### Step 9: 插入用户测试任务（每5个任务）

**关键新要求**：任务展开后，插入面向用户的测试任务。

**逻辑**：
```
每5个任务：
  - 插入新任务："USER-TEST-{N}"
  - 标题："用户验证检查点{N}"
  - 描述："手动测试任务{start}到{end}的功能"

示例：
  - 任务001到005 → 在任务005后插入USER-TEST-1
  - 任务006到010 → 在任务010后插入USER-TEST-2
```

#### Step 10: 设置跟踪脚本

在 `.taskmaster/scripts/` 中创建自动化脚本：

**要创建的脚本**：

1. **track-time.py** - 真实日期时间跟踪，包含UTC时间戳
2. **rollback.sh** - 任意任务检查点的git回滚
3. **learn-accuracy.py** - 估计准确性学习
4. **security-audit.py** - 自动生成安全检查清单
5. **execution-state.py** - 崩溃恢复状态管理

#### Step 11: 选择下一步操作（移交vs自主执行）

**关键选择**：PRD和任务准备好后，询问用户希望如何继续。

使用AskUserQuestion工具呈现两个主要选项：

```
使用AskUserQuestion：

问题：
  - question: "您的PRD和任务已准备好。您希望如何继续？"
    header: "下一步操作"
    multiSelect: false
    options:
      - label: "显示TaskMaster命令"
        description: "移交TaskMaster。我将向您展示运行任务的手动命令。完全控制。"

      - label: "自主执行"
        description: "我将为您自主执行任务，有4种执行模式可供选择。"
```

#### Step 12: 呈现最终摘要

**摘要取决于所采取的路径**：

##### 如果移交TaskMaster（Step 11选项A）：

```
✅ PRD完成

📄 PRD已创建：.taskmaster/docs/prd.md
✅ TaskMaster已初始化：使用{MCP/CLI}
📋 任务已生成：{X}任务（{Y}实现 + {Z}用户测试）
🔄 任务已展开：{N}子任务
📊 脚本已创建：.taskmaster/scripts/（5个自动化脚本）

📊 概览：
  - 功能：{名称}
  - 复杂度：{简单/中等/复杂}
  - 估计工作：{X}任务，~{Y}小时
  - 关键目标：{主要成功指标}

🎯 关键需求：
  1. {顶级功能需求}
  2. {第二功能需求}
  3. {第三功能需求}

⚠️ 质量验证：{分数}/60
  ✅ 通过全部13项验证检查

📋 任务分解：
  - 阶段1：{X}任务
  - 阶段2：{X}任务
  - 阶段3：{X}任务
  - 阶段4：{X}任务

👤 用户测试检查点：
  - USER-TEST-1：任务{N}之后
  - USER-TEST-2：任务{N}之后
  - USER-TEST-3：任务{N}之后

🚀 下一步：

运行：taskmaster next-task

或使用TaskMaster MCP工具管理任务。

参见上述命令以了解完整的TaskMaster使用方式。

✨ PRD生成完成！准备构建。
```

然后退出Skill。

##### 如果自主执行（Step 11选项B）：

```
✅ PRD完成 - 开始自主执行

📄 PRD：.taskmaster/docs/prd.md
✅ TaskMaster：使用{MCP/CLI}
📋 任务：{X}任务（{Y}实现 + {Z}用户测试）
🔄 子任务：{N}子任务
📊 脚本：就绪（.taskmaster/scripts/）

📊 概览：
  - 功能：{名称}
  - 复杂度：{简单/中等/复杂}
  - 模式：{选择的执行模式}
  - 下一个检查点：{下一个用户测试}

⚠️ 质量：{分数}/60 ✅

🚀 执行开始！

选择：{执行模式名称}

[如果顺序/并行：]
下一步：任务{start}-{end} → USER-TEST-{N}
在检查点之前自主工作...

[如果完全自主：]
所有{X}任务将并行执行
在完成之前自主工作...

[如果手动：]
等待您的命令...

输入"begin"或"start"执行！
```

然后使用所选模式的提示模板继续自主执行。

---

## 🔀 模式切换与智能引导

### 如何切换模式

如果您在使用过程中想要切换模式，只需告诉我：

```
示例：
"我想学习PRD最佳实践" → 自动进入🎓学习模式
"我需要生成一个PRD" → 自动进入🔧通用模式
"我想要使用TaskMaster" → 自动进入🚀TaskMaster模式
```

### 智能引导界面

如果您输入含糊不清或我无法确定您的需求，我会显示引导界面：

```
🤔 我注意到您的需求可能属于以下几种情况：

请告诉我您更希望：

1️⃣  **学习PRD方法论**
   我想了解如何写PRD、学习最佳实践、掌握文档协作技巧
   → 适合：新手、想要提升写作能力

2️⃣  **生成通用PRD**
   为某个功能/产品创建标准的产品需求文档
   → 适合：产品经理、需要快速生成PRD

3️⃣  **TaskMaster完整工作流**
   生成PRD并自动分解为任务，支持自动执行
   → 适合：工程师、需要端到端解决方案

请输入1、2或3，或者更详细地描述您的需求。
```

### 保持上下文

在模式之间切换时，我会保留重要信息：
- 已创建的PRD
- 任务状态
- 用户偏好

---

## 📚 详细参考文档

本Skill的 `references/` 目录包含以下详细参考文档：

### 来自 prd-master
- `prd-guide-part1.md` - PRD核心思路完整指南
- `prd-guide-part2.md` - PRD整体设计完整指南
- `prd-practical-guide.md` - PRD实战指南
- `case-user-registration.md` - 用户注册功能完整案例
- `tech-writing-guide.md` - 高质量技术文章写作指南
- `templates.md` - 文档模板集合

### 来自 prd-generator
- `metrics_frameworks.md` - PM指标指南（AARRR、HEART、OKRs）
- `user_story_examples.md` - 用户故事模式和示例

### 来自 prd-taskmaster
- `taskmaster-integration-guide.md` - TaskMaster集成完整指南
- `validation-checklist.md` - 13项自动化质量检查清单

## 📁 模板库

本Skill的 `templates/` 目录包含以下模板：

### 通用模板
- `general-prd-template.md` - 标准13部分PRD模板
- `comprehensive-prd-template.md` - TaskMaster优化完整模板（11部分）
- `minimal-prd-template.md` - 精简版PRD模板
- `taskmaster-prd-template.md` - TaskMaster专用模板
- `CLAUDE.md.template` - Claude项目模板

---

## 🚦 快速参考

### 模式选择快速指南

| 您的需求 | 推荐模式 | 原因 |
|----------|----------|------|
| 学习如何写PRD | 🎓 学习模式 | 全面掌握方法论和最佳实践 |
| 快速生成标准PRD | 🔧 通用生成 | 5步工作流，13部分模板 |
| 需要任务分解和执行 | 🚀 TaskMaster模式 | 12步工作流，13项验证，4种执行模式 |

### PRD文档检查清单
- [ ] 背景、问题、价值、目的是否清晰
- [ ] 整体设计是否完整（流程图、架构图等）
- [ ] 功能描述是否详细（字段、逻辑、校验）
- [ ] 是否使用"条件-动作-预期"表达
- [ ] 是否有清晰的命名和版本规范
- [ ] 是否建立了与技术文档的关联

### 协作流程检查清单
- [ ] 是否建立了需求澄清机制
- [ ] 是否有技术方案评审流程
- [ ] 是否使用统一的ID体系
- [ ] 是否有版本控制机制
- [ ] 是否有文档同步检查

---

## 💡 使用提示

### 获得最佳结果

**了解工作流**：
- 此Skill主要生成PRDs（带可选执行）
- 如果您已有PRD，Skill会检测并提供选项
- 默认行为：生成PRD → 移交TaskMaster
- 可选：PRD准备好后选择自主执行

**提前提供上下文**：
- 发现中更详细的信息 → 更好的PRD
- 分享约束、依赖、假设
- 提及要集成的现有系统

**对成功要具体**：
- 量化目标（不是"改善UX"而是"将NPS从45提高到60"）
- 定义"完成"的样子
- 指定如何衡量成功

**选择正确路径**：
- **移交TaskMaster**（默认）：如果您想要完全控制
- **自主执行**：如果您信任流程并想要速度
  - 顺序到检查点：质量导向，在验证点停止
  - 并行到检查点：更快，在检查点停止
  - 完全自主：最大速度，跳过验证
  - 手动控制：您决定每一步

**如果使用现有PRD**：
- 选项1：执行任务（从上次中断的地方继续）
- 选项2：更新PRD（添加新需求）
- 选项3：替换PRD（重新开始，旧PRD已备份）
- 选项4：审查PRD（只是阅读）

**利用自动化**（如果使用自主执行）：
- 使用日期时间跟踪改善估计
- 如果需要撤销工作使用回滚
- 让准确性学习调整您的估计
- 部署前审查安全审计

**信任流程**：
- 用户测试检查点及早发现问题
- Git检查点允许轻松回滚
- progress.md准确显示发生了什么
- TaskMaster集成确保流畅工作流

---

## 📊 版本历史

### v3.0（当前） - 统一PRD工作台
- ✅ 智能模式检测（学习/通用/TaskMaster）
- ✅ 三种模式整合到一个Skill
- ✅ 渐进式用户引导
- ✅ 向后兼容原有调用方式

### 之前版本
- v2.0: TaskMaster集成
- v1.0: 通用PRD生成
- prd-master v1.1: PRD方法论指南

---

**记住**：全面的PRD与自动化质量控制和TaskMaster集成是成功实施的基础。此Skill专注于创建那个基础。执行是可选的 - 您总是可以移交TaskMaster以获得更多控制。

---

**创建日期**: 2025-12-07
**最后更新**: 2025-12-07
**版本**: 3.0.0
**来源**:
- 产品需求文档完整指南（prd-master）
- PRD生成最佳实践（prd-generator）
- TaskMaster工作流（prd-taskmaster）
- 智能路由系统（新增）
