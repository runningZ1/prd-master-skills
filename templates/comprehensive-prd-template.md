# PRD：[功能/产品名称]

**作者：** [姓名]  
**日期：** [YYYY-MM-DD]  
**状态：** Draft | In Review | Approved  
**版本：** 1.0  
**Taskmaster 优化：** 是

---

## 目录
1. [执行摘要](#执行摘要)  
2. [问题陈述](#问题陈述)  
3. [目标与成功指标](#目标与成功指标)  
4. [用户故事](#用户故事)  
5. [功能需求](#功能需求)  
6. [非功能需求](#非功能需求)  
7. [技术考虑](#技术考虑)  
8. [实施路线图](#实施路线图)  
9. [范围外](#范围外)  
10. [未决问题与风险](#未决问题与风险)  
11. [验证检查点](#验证检查点)  
12. [附录：任务拆解提示](#附录任务拆解提示)  

---

## 执行摘要

用 2-3 句话说明：在解决什么问题、方案、预期影响。  
示例：
> 当前缺少安全认证，导致 15% 账号被攻破。我们将实现 SMS 与 OTP 的双因子认证，预计上线后 3 个月内将攻破率降至 <1%。

---

## 问题陈述

### 现状
[描述当前状态及不足]

### 用户影响
- **受影响用户**：…  
- **痛点表现**：…  
- **严重程度**：Critical/High/Medium（用数据支撑）  

### 业务影响
- **成本**：流失/收入/工单等量化  
- **机会成本**：不做会失去什么  
- **战略匹配**：与公司目标的关联  

### 为什么现在做
[时机、市场、竞争、技术成熟度等]

---

## 目标与成功指标

### 目标1：[主要目标]
- 描述 / 指标 / 基线 / 目标值 / 时间 / 监测方式  

示例：
```
目标：降低账号安全事件
指标：每月被攻破账号数
基线：150 次/月（近 6 个月均值）
目标：<10 次/月（降幅 93%）
时间：上线后 3 个月
监测：安全事件日志 + 用户举报
```

### 目标2/3…
[按相同结构填写]

---

## 用户故事

### 故事 1：[功能名称]
**作为** [用户类型]，**我希望** [动作]，**从而** [收益]。  

**验收标准：**
- [ ] 具体、可测试的条件1  
- [ ] 条件2  
- [ ] 边界/异常处理  

**任务拆解提示：**
- 任务 1.1：…（~X 小时）  
- 任务 1.2：…  

**依赖**：无 / REQ-XXX / 其他故事  

> 示例：2FA 启用流程——可从账号设置进入；支持 SMS 与 OTP；需验证后才能开启；生成二维码和备份码；启用后发送确认邮件等。

---

## 功能需求

### Must Have（P0）
#### REQ-001：[需求标题]
**描述**：系统必须…  

**验收标准：**
- [ ] …  
- [ ] …  

**技术规格（可用代码/API示例）：**
```typescript
// 例如：POST /api/auth/login
```

**任务拆解：**
- 实现…（Small/Medium/ Large，含预估）  

**依赖**：无 / REQ-XXX / 外部服务  

---

### Should Have（P1）
#### REQ-00X：[需求标题]
[同上结构]

### Nice to Have（P2）
#### REQ-00Y：[需求标题]
[同上结构]

---

## 非功能需求

### 性能
- API：p95 < 200ms  
- DB 查询：< 100ms（单条）  
- 页面加载：< 2s（4G）  

### 安全
- 认证：JWT 过期策略、刷新策略  
- 授权：RBAC、最小权限、敏感操作审计  
- 数据：密码 bcrypt；敏感数据加密；全站 TLS  

### 可扩展性
- 用户量：初始 10 万，6 个月扩展至 100 万  
- 数据量：初始 1GB，月增 ~100MB，保留 7 年  
- 架构：支持水平扩展/K8s；CDN 静态加速  

### 可靠性
- SLA 99.9%；RTO < 1h；RPO < 15min  
- 错误率 <0.1%；外部依赖熔断与降级  
- 监控告警：健康检查 30s，错误率>1%告警  

### 可访问性/兼容性
- WCAG 2.1 AA；键盘可操作；ARIA 标签  
- 浏览器：Chrome/Firefox/Safari/Edge 近两版  
- 设备：桌面/平板/手机，移动端 iOS14+ / Android10+  

---

## 技术考虑

### 架构
- **当前**：如已有系统，请描述  
- **拟议变更**：功能如何接入/影响现有架构  
- **示意**：可用 ASCII/外链图  

### API 规格（示例）
```
POST /api/v1/users
Headers: Content-Type: application/json
Request/Response/Error 示例…
```

### 数据库
- 新表 / 变更表的 SQL 样例与索引策略  

### 技术栈
- 前端/后端/数据库/基础设施/CI/CD 选型

### 外部依赖
- 第三方：用途、API、速率、降级策略  
- 内部：用户服务/邮件/分析等依赖

### 迁移策略（如改造存量系统）
1) 先跑迁移（零停机）  
2) 代码上线但功能开关关闭  
3) Beta 灰度（5%→25%→50%→100%）  
4) 回滚：关闭开关；数据库兼容无需回滚  

### 测试策略
- 单测覆盖目标与关键点  
- 集成/E2E：核心流程与异常  
- 性能：并发/压力/耐久  
- 安全：渗透/OWASP/top 风险校验

---

## 实施路线图

### 阶段 1：基础（周1-2）
目标、任务列表、复杂度、依赖、负责人  
**检查点**：达到什么标准才能进入下一阶段

### 阶段 2：核心功能（周3-4）
同上

### 阶段 3：扩展/集成（周5…）
同上

### 阶段 4：测试与打磨
测试套件、性能/安全、缺陷修复

### 阶段 5：发布与渐进放量
5%→25%→50%→100%，监控与沟通

**任务依赖示意**：可用文本列出关键链路与关键路径。

**工作量估算**：按阶段合计小时/人周；含风险缓冲。

---

## 范围外
明确本次不做的项与原因；如后续版本再评估。  
示例：生物识别、硬件钥匙、组织强制 2FA 等。

---

## 未决问题与风险

### 未决问题
- Q1：… 选项/负责人/截止时间/影响  
- Q2：…  

### 风险与缓解

| 风险 | 可能性 | 影响 | 等级 | 缓解 | 兜底 |
|------|--------|------|------|------|------|
| 示例：SMS 投递失败 | 高 | 高 | 严重 | 可靠供应商+重试 | 退回 TOTP，清晰提示 |
| 示例：2FA 设备丢失 | 中 | 高 | 高 | 备份码教育 | 人工验证流程 |

---

## 验证检查点

### 检查点 1（如：阶段1完成）
- [ ] 必须达成的标准列表  
**失败处理**：需修复哪些再继续

### 检查点 2/3…
[同上，覆盖各阶段结束与上线前]

### 上线阶段检查
- 错误率、成功率、关键指标无劣化等

---

## 附录：任务拆解提示（示例）

### 建议的任务结构
**环境/准备（~10h）**：迁移、配置、第三方接入  
**后端实现（~45h）**：TOTP 生成/校验、启用/验证接口、登录校验、速率限制等  
**前端实现（~30h）**：设置页、二维码、SMS 流程、登录二次验证、备份码展示  
**测试（~24h）**：单测/集成/E2E/性能  
**文档与发布（~10h）**：API 文档、用户指引、上线/监控  

### 可并行
- 后端与前端大部分任务可并行  
- 测试在功能完成后并行推进  
- 文档可在测试阶段开始撰写

### 顺序性强的任务
- 迁移 → 核心实现 → 测试 → 部署/放量

### 关键路径（示例）
迁移 → TOTP 生成 → 验证 → 启用接口 → 登录校验 → 测试 → 发布与放量

---

**文档结束**

*本模板为任务拆解友好格式，包含依赖与时间估算占位，便于自动或人工计划。*
